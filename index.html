<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Presentation</title>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  

  

  <script type="text/javascript">
  $(function(){
    setupPreso(false, './');
  });
  </script>
</head>

<body>


<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">&larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">z</td><td>toggle help (this)</td></tr>
  </table>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content center" ref="title/1">
<h1>Building a Ruby application with jruby-complete</h1>

<h3>Matt Fletcher - Atomic Object</h3>

<p><img src="./file/title/ao_logo.png" alt="atomicobject.com"/></p></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="intro/1/1">
<h1>JRuby</h1>

<p><img src="./file/intro/jruby1.png" alt="jruby.org"/></p>

<h1>Ruby running on the JVM</h1></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="intro/1/2">
<h1>jruby-complete</h1>

<p><img src="./file/intro/jrubygiftsized.jpg" alt="jruby-complete"/></p>

<h1>JRuby in a single jar file</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="intro/1/3">
<h1>who cares? why?</h1>

<ul>
<li>control your Ruby runtime!</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="intro/1/4">
<h1>embed Ruby runtime</h1>

<ul>
<li>no need to install Ruby</li>
<li>control precisely what Ruby you're using (sort stability!)</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="intro/1/5">
<h1>constrained environment</h1>

<ul>
<li>servers not under your control</li>
<li>AIX, HPUX, Solaris, QNX, etc</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="intro/1/6">
<h1>jruby-complete: one file!</h1></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="direct/1/1">
<h2>Running jruby-complete directly</h2></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="direct/1/2">
<h1>baseline</h1>

<pre><code><code class="command">$ java -jar jruby-complete-1.4.0.jar</code><code class="result">

</code><code class="command">$ java -jar jruby-complete-1.4.0.jar -e "puts 'Ahoy'"</code><code class="result">
  Ahoy
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline" ref="direct/1/3">
<h1>JVM heap and stack</h1>

<pre><code><code class="command">$ java -Xmx500m -Xss1024k \</code><code class="result">
</code><code class="command">$ -jar jruby-complete-1.4.0.jar -e "puts 'Ahoy'"</code><code class="result">
  Ahoy
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content command commandline" ref="direct/1/4">
<h1>irb</h1>

<pre><code><code class="command">$ java -Xmx500m -Xss1024k \</code><code class="result">
</code><code class="command">$ -jar jruby-complete-1.4.0.jar -S jirb</code><code class="result">
  irb(main):001:0&gt; puts "Ahoy"
  Ahoy
  =&gt; nil
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="direct/1/5">
<h1>Rakefile</h1>

<pre class="sh_ruby"><code>JRUBY_COMPLETE = "jruby-complete-1.4.0.jar"
JRUBY = "java -Xmx500m -Xss1024k " \
        "-jar #{JRUBY_COMPLETE}"</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="direct/1/6">
<h1>Rakefile</h1>

<pre class="sh_ruby"><code>namespace :jruby do
  desc "Run JRuby help"
  task :help do
    sh %+#{JRUBY} --help+
  end

  desc "Run any command with JRuby"
  task :run do
    sh %+#{JRUBY} -e '#{ENV["cmd"]}'+
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="direct/1/7">
<pre><code><code class="command">$ rake jruby:run cmd='puts "Hello"'</code><code class="result">
  Hello
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="direct/2/1">
<h2>Running an application and specs</h2></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="direct/2/2">
<h1>lib/application_bootstrap.rb</h1>

<pre class="sh_ruby"><code>puts 'Hello from application_bootstrap'</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="direct/2/3">
<h1>Rakefile</h1>

<pre class="sh_ruby"><code>task :run do
  sh "#{JRUBY} lib/application_bootstrap.rb"
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="direct/2/4">
<pre><code><code class="command">$ rake run</code><code class="result">
java -Xmx500m -Xss1024k -jar jruby-complete-1.4.0.jar \
lib/application_bootstrap.rb
Hello from application_bootstrap
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="direct/2/5">
<h2>Ruby executables</h2>

<ul>
<li>use -S to run commands in JRuby's bin directory</li>
<li>For jruby-complete, this means the bin tucked inside the jar</li>
<li>RSpec, Rake built into jruby-complete</li>
<li>Other executables like jrubyc</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content command" ref="direct/2/6">
<h1>Rakefile</h1>

<pre class="sh_ruby"><code>namespace :spec do
  desc "Run RSpec against a specific file"
  task :run do
    sh "#{JRUBY} -S spec -f specdoc " \
       "#{ENV['spec']}"
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="direct/2/7">
<h1>spec/unit/objectivism_spec.rb</h1>

<pre class="sh_ruby"><code>describe "John Galt" do
  it "doesn't tolerate logical fallacies" do
    "A".should == "A"
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="direct/2/8">
<pre><code><code class="command">$ rake spec:run spec=spec/unit/objectivism_spec.rb</code><code class="result">
java -Xmx500m -Xss1024k -jar jruby-complete-1.4.0.jar \
-S spec -f specdoc spec/unit/objectivism_spec.rb

John Galt
- doesn't tolerate logical fallacies

Finished in 0.123 seconds

1 example, 0 failures
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="direct/3/1">
<h2>aliases and functions</h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="direct/3/2">
<ul>
<li>Some commands are getting cumbersome</li>
<li>Your shell can help!</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="direct/3/3">
<pre><code><code class="command">$ which sp</code><code class="result">
sp () {
        rake spec:run spec=$@
}

</code><code class="command">$ sp spec/unit/objectivism_spec.rb</code><code class="result">
java -Xmx500m -Xss1024k -jar jruby-complete-1.4.0.jar \
-S spec -f specdoc spec/unit/objectivism_spec.rb
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="compile/1/1">
<h2>Compiling Ruby code</h2></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="compile/1/2">
<h1>Rakefile</h1>

<pre class="sh_ruby"><code>require "rake/clean"

namespace :jruby do
  output_directory = "classes"
  directory output_directory
  CLEAN.include output_directory

  desc "Compile Ruby files in lib"
  task :compile =&gt; output_directory do
    sh "#{JRUBY} -S jrubyc " \
       "-p com/atomicobject " \
       -t #{output_directory} lib"
  end
end</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="compile/1/3">
<pre><code><code class="command">$ rake jruby:compile</code><code class="result">
java -Xmx500m -Xss1024k -jar jruby-complete-1.4.0.jar
-S jrubyc -p com/atomicobject -t classes lib

Compiling lib/application_bootstrap.rb to class
com/atomicobject/lib/application_bootstrap
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental" ref="compile/1/4">
<h2>Run it</h2>

<pre><code><code class="command">$ rake jruby:run cmd='require \</code><code class="result">
</code><code class="command">$ "classes/com/atomicobject/lib/application_bootstrap"'</code><code class="result">
java -Xmx500m -Xss1024k -jar jruby-complete-1.4.0.jar ...
Hello from application_bootstrap
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="conclusion/1/1">
<h1>Conclusion</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="conclusion/1/2">
<h1>Further work</h1>

<ul>
<li>Use <a href="http://code.google.com/p/jarjar">JarJar Links</a> to wrap jruby-complete, Ruby files, 3rd-party gems and jars into one file</li>
<li>new CompoundJarClassLoader in JRuby - eliminates need for JarJar?</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smbullets" ref="conclusion/1/3">
<h1>Additional resources</h1>

<ul>
<li>This presentation: <a href="http://github.com/fletcherm/grruby-jruby-complete">http://github.com/fletcherm/grruby-jruby-complete</a></li>
<li>fletcherm-culerity: <a href="http://github.com/fletcherm/culerity">http://github.com/fletcherm/culerity</a></li>
<li>Running a Ruby application with jruby-complete: <a href="http://spin.atomicobject.com/2010/02/01/running-a-ruby-application-with-jruby-complete">http://spin.atomicobject.com/2010/02/01/running-a-ruby-application-with-jruby-complete</a></li>
<li>Rolling a JRuby desktop application: <a href="http://spin.atomicobject.com/2008/07/02/rolling-a-jruby-desktop-application">http://spin.atomicobject.com/2008/07/02/rolling-a-jruby-desktop-application</a></li>
<li>Ruby for desktop applications? Yes we can.: <a href="http://spin.atomicobject.com/2009/01/30/ruby-for-desktop-applications-yes-we-can">http://spin.atomicobject.com/2009/01/30/ruby-for-desktop-applications-yes-we-can</a></li>
</ul>
</div>
</div></div>

</body>
</html>
